"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[118],{38144:function(j,c,a){a.d(c,{Z:function(){return s}});var k=a(26042),l=a(69396),m=a(99534),n=a(85893);a(67294);var o=a(7297),b=a(87379),d=a(57247),e=a(44850);function f(){var a=(0,o.Z)(["\n  0% {\n    background-position: 50% 0%;\n  }\n  50% {\n    background-position: 50% 100%;\n  }\n  100% {\n    background-position: 50% 0%;\n  }\n"]);return f=function(){return a},a}function p(){var a=(0,o.Z)(["\n      animation: "," 3s ease infinite;\n      background-size: 400% 400%;\n    "]);return p=function(){return a},a}function g(){var a=(0,o.Z)(["\n  background: ",";\n  border-radius: ",";\n  color: ",";\n  overflow: hidden;\n  position: relative;\n\n  ","\n\n  padding: 1px 1px 3px 1px;\n\n  ","\n"]);return g=function(){return a},a}function h(){var a=(0,o.Z)(["\n  width: 100%;\n  height: 100%;\n  overflow: ",";\n  background: ",";\n  border-radius: ",";\n"]);return h=function(){return a},a}var q=(0,b.F4)(f()),i=b.ZP.div.withConfig({componentId:"sc-eecfaa46-0"}).withConfig({componentId:"sc-62e22978-0"})(g(),function(a){var c=a.isActive,d=a.isSuccess,e=a.isWarning,f=a.borderBackground,b=a.theme;return f||(e?b.colors.warning:d?b.colors.success:c?"linear-gradient(180deg, ".concat(b.colors.primaryBright,", ").concat(b.colors.secondary,")"):b.colors.cardBorder)},function(a){return a.theme.radii.card},function(a){var b=a.theme,c=a.isDisabled;return b.colors[c?"textDisabled":"text"]},function(a){return a.isActive&&(0,b.iv)(p(),q)},d.Dh),r=(0,b.ZP)(e.Z).withConfig({componentId:"sc-eecfaa46-1"}).withConfig({componentId:"sc-62e22978-1"})(h(),function(a){return a.hasCustomBorder?"initial":"inherit"},function(a){var c=a.theme,b=a.background;return null!=b?b:c.card.background},function(a){return a.theme.radii.card});i.defaultProps={isActive:!1,isSuccess:!1,isWarning:!1,isDisabled:!1};var s=function(a){var c=a.ribbon,d=a.children,e=a.background,b=(0,m.Z)(a,["ribbon","children","background"]);return(0,n.jsx)(i,(0,l.Z)((0,k.Z)({},b),{children:(0,n.jsxs)(r,{background:e,hasCustomBorder:!!b.borderBackground,children:[c,d]})}))}},118:function(m,d,a){a.r(d),a.d(d,{default:function(){return N}});var b,e,n,o,p,q=a(26042),r=a(10253),s=a(7297),t=a(85893),u=a(37519),v=a(99150),c=a(87379),f=a(38144),g=a(4318),h=a(44850),w=a(36544),x=a(97114),y=a(82035),z=a(68605),A=a(47568),i=a(34051),B=a.n(i),C=a(67294),D=a(28687),E=a(65684),F=a(85906),G=a(27892);function H(){var a=(0,s.Z)(['\n            query getNftMarketSubgraphHealth {\n              indexingStatusForCurrentVersion(subgraphName: "','") {\n                synced\n                health\n                chains {\n                  chainHeadBlock {\n                    number\n                  }\n                  latestBlock {\n                    number\n                  }\n                }\n              }\n            }\n          ']);return H=function(){return a},a}(b=e||(e={}))[b.OK=0]="OK",b[b.WARNING=1]="WARNING",b[b.NOT_OK=2]="NOT_OK",b[b.UNKNOWN=3]="UNKNOWN";var I=function(b){var a=(0,C.useState)({status:e.UNKNOWN,currentBlock:0,chainHeadBlock:0,latestBlock:0,blockDifference:0}),c=a[0],d=a[1];return(0,G.X)(function(c){var a;(a=(0,A.Z)(B().mark(function a(){var f,g,h,i,j,k,l,m;return B().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.t0=r.Z,a.next=4,Promise.all([(0,D.request)(F.AM,(0,D.gql)(H(),b)),c?Promise.resolve(c):E.v.getBlockNumber(),]);case 4:a.t1=a.sent,g=(f=(0,a.t0)(a.t1,2))[0].indexingStatusForCurrentVersion,h=f[1],i="healthy"===g.health,j=parseInt(g.chains[0].chainHeadBlock.number),k=parseInt(g.chains[0].latestBlock.number),l=h-k,m=h-j,!i||l>200||m>200?d({status:e.NOT_OK,currentBlock:h,chainHeadBlock:j,latestBlock:k,blockDifference:l}):l>50||m>50?d({status:e.WARNING,currentBlock:h,chainHeadBlock:j,latestBlock:k,blockDifference:l}):d({status:e.OK,currentBlock:h,chainHeadBlock:j,latestBlock:k,blockDifference:l}),a.next=19;break;case 16:a.prev=16,a.t2=a.catch(0),console.error("Failed to perform health check for ".concat(b," subgraph"),a.t2);case 19:case"end":return a.stop()}},a,null,[[0,16]])})),function(){return a.apply(this,arguments)})()},[b]),c};function j(){var a=(0,s.Z)(["\n  border-radius: 8px;\n  > div {\n    border-radius: 8px;\n  }\n  user-select: none;\n"]);return j=function(){return a},a}function k(){var a=(0,s.Z)(["\n  gap: 7px;\n"]);return k=function(){return a},a}function l(){var a=(0,s.Z)(["\n  width: 12px;\n  height: 12px;\n  border-radius: 50%;\n  background: ",";\n"]);return l=function(){return a},a}var J=(0,c.ZP)(f.Z).withConfig({componentId:"sc-f38aa051-0"})(j()),K=(0,c.ZP)(g.Z).withConfig({componentId:"sc-f38aa051-1"})(k()),L=(0,c.ZP)(h.Z).withConfig({componentId:"sc-f38aa051-2"})(l(),function(a){var b=a.$color,c=a.theme;return c.colors[b]}),M=function(a){var e=a.color,f=a.label,g=a.description,c=a.currentBlock,i=a.secondRemainingBlockSync,d=a.blockNumberFromSubgraph,b=(0,v.$G)().t;return(0,t.jsxs)(h.Z,{children:[(0,t.jsxs)(K,{pb:"10px",children:[(0,t.jsx)(L,{$color:e}),(0,t.jsx)(x.Z,{children:f})]}),(0,t.jsx)(x.Z,{pb:"24px",children:g}),(0,t.jsxs)(x.Z,{children:[(0,t.jsxs)("strong",{children:[b("Chain Head Block"),":"]})," ",c]}),(0,t.jsxs)(x.Z,{children:[(0,t.jsxs)("strong",{children:[b("Latest Subgraph Block"),":"]})," ",d]}),(0,t.jsxs)(x.Z,{children:[(0,t.jsxs)("strong",{children:[b("Delay"),":"]})," ",c-d," (",i,"s)"]})]})},N=function(d){var a,b,j,B=d.subgraphName,C=d.inline,D=d.customDescriptions,E=d.obeyGlobalSetting,F=(0,v.$G)().t,f=I(B),g=f.status,k=f.currentBlock,G=f.blockDifference,l=f.latestBlock,H=(0,r.Z)((0,z.YF)(),1),N=H[0],O=g===e.WARNING||g===e.NOT_OK,P=(a=F,b=D,{delayed:{label:a("Delayed"),color:"failure",description:null!==(n=null==b?void 0:b.delayed)&& void 0!==n?n:a("Subgraph is currently experiencing delays due to BSC issues. Performance may suffer until subgraph is restored.")},slow:{label:a("Slight delay"),color:"warning",description:null!==(o=null==b?void 0:b.slow)&& void 0!==o?o:a("Subgraph is currently experiencing delays due to BSC issues. Performance may suffer until subgraph is restored.")},healthy:{label:a("Fast"),color:"success",description:null!==(p=null==b?void 0:b.healthy)&& void 0!==p?p:a("No issues with the subgraph.")}}),Q=G*u.hJ,c=P[(j=g)===e.NOT_OK?"delayed":j===e.WARNING?"slow":"healthy"],i=(0,w.Z)((0,t.jsx)(M,(0,q.Z)({currentBlock:k,secondRemainingBlockSync:Q,blockNumberFromSubgraph:l},c)),{placement:"top"}),m=i.targetRef,s=i.tooltipVisible,A=i.tooltip;return l&&k&&(E&&N||O)?C?(0,t.jsxs)(K,{alignItems:"center",justifyContent:"flex-end",ref:m,children:[(0,t.jsx)(L,{$color:c.color}),(0,t.jsx)(x.Z,{children:c.label}),(0,t.jsx)(y.Z,{}),s&&A]}):(0,t.jsxs)(h.Z,{position:"fixed",bottom:"55px",right:"5%",ref:m,"data-test":"subgraph-health-indicator",children:[s&&A,(0,t.jsx)(J,{children:(0,t.jsxs)(K,{alignItems:"center",p:"10px",children:[(0,t.jsx)(L,{$color:c.color}),(0,t.jsx)(x.Z,{children:c.label}),(0,t.jsx)(y.Z,{})]})})]}):null}}}])
//# sourceMappingURL=118.d6da20b3d884b62d.js.map