(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4169],{42379:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/voting/proposal/create",function(){return c(50416)}])},9511:function(i,c,a){"use strict";var j=a(7297),k=a(29815),d=a(85893),l=a(67294),b=a(87379),e=a(57247),f=a(94528);function g(){var a=(0,j.Z)(["\n  align-items: center;\n  color: ",";\n  display: flex;\n  justify-content: center;\n  padding-left: 4px;\n  padding-right: 4px;\n\n  "," {\n    padding-left: 8px;\n    padding-right: 8px;\n  }\n\n  "," {\n    padding-left: 16px;\n    padding-right: 16px;\n  }\n"]);return g=function(){return a},a}function h(){var a=(0,j.Z)(["\n  align-items: center;\n  display: flex;\n  flex-wrap: wrap;\n  list-style-type: none;\n\n  a {\n    color: ",";\n\n    &:hover {\n      color: ",";\n    }\n  }\n\n  ","\n"]);return h=function(){return a},a}var m=b.ZP.div.withConfig({componentId:"sc-dc391a6e-0"}).withConfig({componentId:"sc-aeea62df-0"})(g(),function(a){return a.theme.colors.textDisabled},function(a){return a.theme.mediaQueries.sm},function(a){return a.theme.mediaQueries.md}),n=b.ZP.ul.withConfig({componentId:"sc-dc391a6e-1"}).withConfig({componentId:"sc-aeea62df-1"})(h(),function(a){return a.theme.colors.primary},function(a){return a.theme.colors.primaryBright},e.Dh),o=(0,d.jsx)(f.Z,{color:"currentColor",width:"24px"});c.Z=function(a){var b,e,c=a.separator,f=a.children,g=(b=l.Children.toArray(f).filter(function(a){return(0,l.isValidElement)(a)}),e=void 0===c?o:c,b.reduce(function(a,b,c){return 0===c?(0,k.Z)(a).concat([b]):(0,k.Z)(a).concat([(0,d.jsx)(m,{"aria-hidden":!0,children:e},"separator-".concat(c)),b,])},[]));return(0,d.jsx)(n,{children:g.map(function(a,b){return(0,d.jsx)("li",{children:a},"child-".concat(b))})})}},50416:function(q,c,a){"use strict";a.r(c),a.d(c,{default:function(){return aH}});var r=a(47568),s=a(14924),t=a(26042),u=a(69396),v=a(10253),e=a(34051),w=a.n(e),x=a(85893),y=a(67294),z=a(65528),A=a(44850),B=a(9511),C=a(97114),D=a(5324),E=a(38144),F=a(87654),G=a(59750),H=a(23774),I=a(4318),J=a(10566),K=a(96293),L=a(19729),M=a(77044),f=a(98913),N=a.n(f),g=a(41609),O=a.n(g),P=a(37063),Q=a(45101),R=a(789),S=a(93293),T=a(53467),U=a(81141),V=a(99150),W=a(55027),X=a(99534),h=a(9198),Y=a.n(h);a(18698);var Z=function(a){var b=a.inputProps,c=(0,X.Z)(a,["inputProps"]);return(0,x.jsx)(Y(),(0,t.Z)({customInput:(0,x.jsx)(D.Z,(0,t.Z)({},void 0===b?{}:b)),portalId:"reactDatePicker",dateFormat:"PPP"},c))},$=a(7297),b=a(87379);function i(){var a=(0,$.Z)(["\n  .react-datepicker-wrapper,\n  .react-datepicker__input-container {\n    display: block;\n  }\n\n  .react-datepicker {\n    background: ",";\n    border-color: ",";\n    color: ",";\n    font-family: 'Kanit', sans-serif;\n  }\n\n  .react-datepicker__header {\n    background: ",";\n    border-color: ",";\n  }\n\n  .react-datepicker__current-month,\n  .react-datepicker-time__header,\n  .react-datepicker-year-header,\n  .react-datepicker__day-name,\n  .react-datepicker__day,\n  .react-datepicker__time-name {\n    color: ",";\n  }\n\n  .react-datepicker__day:hover,\n  .react-datepicker__month-text:hover,\n  .react-datepicker__quarter-text:hover,\n  .react-datepicker__year-text:hover {\n    background-color: ",";\n  }\n\n  .react-datepicker-popper[data-placement^='bottom'] .react-datepicker__triangle::before,\n  .react-datepicker-popper[data-placement^='bottom'] .react-datepicker__triangle::after {\n    border-bottom-color: ",";\n  }\n\n  .react-datepicker__day--selected,\n  .react-datepicker__day--in-selecting-range,\n  .react-datepicker__day--in-range,\n  .react-datepicker__month-text--selected,\n  .react-datepicker__month-text--in-selecting-range,\n  .react-datepicker__month-text--in-range,\n  .react-datepicker__quarter-text--selected,\n  .react-datepicker__quarter-text--in-selecting-range,\n  .react-datepicker__quarter-text--in-range,\n  .react-datepicker__year-text--selected,\n  .react-datepicker__year-text--in-selecting-range,\n  .react-datepicker__year-text--in-range {\n    background-color: ",";\n  }\n\n  .react-datepicker__day--selected:hover,\n  .react-datepicker__day--in-selecting-range:hover,\n  .react-datepicker__day--in-range:hover,\n  .react-datepicker__month-text--selected:hover,\n  .react-datepicker__month-text--in-selecting-range:hover,\n  .react-datepicker__month-text--in-range:hover,\n  .react-datepicker__quarter-text--selected:hover,\n  .react-datepicker__quarter-text--in-selecting-range:hover,\n  .react-datepicker__quarter-text--in-range:hover,\n  .react-datepicker__year-text--selected:hover,\n  .react-datepicker__year-text--in-selecting-range:hover,\n  .react-datepicker__year-text--in-range:hover {\n    background-color: ",";\n  }\n\n  .react-datepicker__day--keyboard-selected,\n  .react-datepicker__month-text--keyboard-selected,\n  .react-datepicker__quarter-text--keyboard-selected,\n  .react-datepicker__year-text--keyboard-selected {\n    background-color: ",";\n    color: #ffffff;\n  }\n\n  .react-datepicker__day--keyboard-selected:hover,\n  .react-datepicker__month-text--keyboard-selected:hover,\n  .react-datepicker__quarter-text--keyboard-selected:hover,\n  .react-datepicker__year-text--keyboard-selected:hover {\n    background-color: ",";\n    color: #ffffff;\n  }\n\n  .react-datepicker__time-container,\n  .react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box {\n    width: 120px;\n  }\n\n  .react-datepicker__header--time {\n    padding: 8px;\n  }\n\n  .react-datepicker__time-container\n    .react-datepicker__time\n    .react-datepicker__time-box\n    ul.react-datepicker__time-list\n    li.react-datepicker__time-list-item {\n    height: auto;\n    padding: 8px;\n  }\n\n  .react-datepicker__time-container\n    .react-datepicker__time\n    .react-datepicker__time-box\n    ul.react-datepicker__time-list\n    li.react-datepicker__time-list-item {\n    background-color: ",";\n\n    &:hover {\n      background-color: ",";\n    }\n  }\n\n  .react-datepicker__time-container\n    .react-datepicker__time\n    .react-datepicker__time-box\n    ul.react-datepicker__time-list\n    li.react-datepicker__time-list-item--selected {\n    color: ",";\n  }\n"]);return i=function(){return a},a}var _=b.ZP.div.withConfig({componentId:"sc-1ce524b4-0"})(i(),function(a){return a.theme.card.background},function(a){return a.theme.colors.cardBorder},function(a){return a.theme.colors.text},function(a){return a.theme.colors.input},function(a){return a.theme.colors.cardBorder},function(a){return a.theme.colors.text},function(a){return a.theme.colors.cardBorder},function(a){return a.theme.colors.cardBorder},function(a){return a.theme.colors.primary},function(a){return a.theme.colors.primaryBright},function(a){return a.theme.colors.secondary},function(a){return a.theme.colors.secondary},function(a){return a.theme.card.background},function(a){return a.theme.colors.cardBorder},function(a){return a.theme.colors.text}),aa=function(){return(0,x.jsx)(_,{id:"reactDatePicker"})},ab=function(a){var b=(0,V.$G)().t;return(0,x.jsx)(Z,(0,t.Z)({showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:15,timeCaption:b("Time"),dateFormat:"ppp"},a))},ac=a(30621),ad=a(71249),ae=a(83559),af=a(11163),j=a(41664),ag=a.n(j),k=a(5152),l=a.n(k),ah=a(97305),ai=a(73408);function m(){var a=(0,$.Z)(["\n  color: ",";\n  display: block;\n  font-weight: 600;\n  margin-bottom: 8px;\n"]);return m=function(){return a},a}function n(){var a=(0,$.Z)(["\n  font-size: 20px;\n"]);return n=function(){return a},a}function o(){var a=(0,$.Z)(["\n  font-size: 12px;\n  text-transform: uppercase;\n"]);return o=function(){return a},a}var d=b.ZP.label.withConfig({componentId:"sc-b1f52df3-0"})(m(),function(a){return a.theme.colors.text}),aj=(0,b.ZP)(d).withConfig({componentId:"sc-b1f52df3-1"})(n()),ak=(0,b.ZP)(d).withConfig({componentId:"sc-b1f52df3-2"})(o()),al=function(a){var b=a.children;return(0,x.jsx)(C.Z,{color:"failure",mb:"4px",children:b})},am=function(a){var b=a.errors;return(0,x.jsx)(A.Z,{mt:"8px",children:b.map(function(a){return(0,x.jsx)(al,{children:a},a)})})},an=a(29815),p=a(73955),ao=a.n(p),ap=a(5527),aq=a(92510),ar=function(a){var b=a.onRemove,g=a.onTextInput,e=(0,X.Z)(a,["onRemove","onTextInput"]),c=(0,y.useState)(!1),f=c[0],h=c[1],d=(0,y.useState)(!1),i=d[0],j=d[1];return(0,x.jsxs)(A.Z,{position:"relative",mb:"16px",children:[(0,x.jsx)(D.Z,(0,u.Z)((0,t.Z)({},e),{onChange:function(b){var a=b.currentTarget.value;h(i&&0===a.length),j(!0),g(a)},isWarning:f})),b&&(0,x.jsx)(A.Z,{position:"absolute",right:"8px",top:"0px",zIndex:30,children:(0,x.jsx)(ap.Z,{variant:"text",onClick:b,children:(0,x.jsx)(aq.Z,{})})})]})},as=function(){return{id:ao()(),value:""}},at=function(a){var b=a.choices,e=a.onChange,c=(0,V.$G)().t,d=b.filter(function(a){return a.value.length>0}).length>=2;return(0,x.jsxs)(E.Z,{children:[(0,x.jsx)(F.Z,{children:(0,x.jsx)(G.Z,{as:"h3",scale:"md",children:c("Choices")})}),(0,x.jsxs)(H.Z,{children:[b.map(function(a,d){var f=a.id,g=a.value;return(0,x.jsx)(ar,{scale:"lg",onTextInput:function(c){var a=(0,an.Z)(b),d=a.findIndex(function(a){return a.id===f});a[d].value=c,e(a)},placeholder:c("Input choice text"),value:g,onRemove:d>1?function(){e(b.filter(function(a){return a.id!==f}))}:void 0},f)}),(0,x.jsx)(K.Z,{type:"button",onClick:function(){e((0,an.Z)(b).concat([as()]))},disabled:!d,children:c("Add Choice")})]})]})},au=a(12274),av=a(42298),aw=a(23855),ax=function(a,b){if(!(0,au.default)(a)||!(0,au.default)(b))return null;var c=(0,av.default)(a,"yyyy-MM-dd"),d=(0,av.default)(b,"HH:mm:ss");return(0,aw.default)("".concat(c,"T").concat(d)).getTime()/1e3},ay=function(c,b){var i=c.name,j=c.body,d=c.choices,e=c.startDate,f=c.startTime,g=c.endDate,h=c.endTime,k=c.snapshot,a={};i||(a.name=[b("%field% is required",{field:"Title"})]),j||(a.body=[b("%field% is required",{field:"Body"})]),d.length<2&&(a.choices=[b("Please create a minimum of %num% choices",{num:2})]);var l=d.some(function(a){return!a.value});2===d.length&&l&&(a.choices=Array.isArray(a.choices)?(0,an.Z)(a.choices).concat([b("Choices must not be empty")]):a.choices=[b("Choices must not be empty")]),(0,au.default)(e)||(a.startDate=[b("Please select a valid date")]),(0,au.default)(f)||(a.startTime=[b("Please select a valid time")]),(0,au.default)(g)||(a.endDate=[b("Please select a valid date")]),(0,au.default)(h)||(a.endTime=[b("Please select a valid time")]);var m=ax(e,f),n=ax(g,h);return n<m&&(a.endDate=Array.isArray(a.endDate)?(0,an.Z)(a.endDate).concat([b("End date must be after the start date")]):a.endDate=[b("End date must be after the start date")]),0===k&&(a.snapshot=[b("Invalid snapshot")]),a},az=a(65398),aA=a(90452),aB=a(63603),aC=a(23917),aD=a(4411),aE=a(6365),aF=function(b){var c=b.block,f=b.onDismiss,d=(0,V.$G)().t,e=(0,y.useState)(!0),g=e[0],s=e[1],a=(0,aD.Z)(c,g),h=a.isLoading,i=a.total,j=a.cakeBalance,k=a.cakeVaultBalance,l=a.cakePoolBalance,m=a.poolsBalance,n=a.cakeBnbLpBalance,o=a.ifoPoolBalance,p=a.lockedCakeBalance,q=a.lockedEndTime,r=(0,aC.ZP)().theme;return(0,x.jsx)(aA.Z,{title:d("Voting Power"),onDismiss:function(){s(!1),f()},headerBackground:r.colors.gradients.cardHeader,children:(0,x.jsx)(A.Z,{mb:"24px",width:["100%","100%","100%","320px"],children:h?(0,x.jsx)(I.Z,{height:"450px",alignItems:"center",justifyContent:"center",children:(0,x.jsx)(aB.Z,{size:80})}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(aE.Z,{total:i,cakeBalance:j,cakeVaultBalance:k,cakePoolBalance:l,poolsBalance:m,ifoPoolBalance:o,cakeBnbLpBalance:n,lockedCakeBalance:p,lockedEndTime:q,block:c}),(0,x.jsx)(K.Z,{variant:"secondary",onClick:f,width:"100%",mt:"16px",children:d("Close")})]})})})},aG=l()(function(){return Promise.all([a.e(3126),a.e(9094),a.e(4807)]).then(a.bind(a,74357))},{loadableGenerated:{webpack:function(){return[74357]}},ssr:!1}),aH=function(){var n,h=(0,y.useState)(function(){return{name:"",body:"",choices:N()(2).map(as),startDate:null,startTime:null,endDate:null,endTime:null,snapshot:0}}),c=h[0],o=h[1],i=(0,y.useState)(!1),j=i[0],aq=i[1],k=(0,y.useState)({}),d=k[0],ar=k[1],a=(0,V.$G)().t,e=(0,M.Ge)().account,p=(0,P.Xh)(),au=(0,af.useRouter)().push,av=(0,U.QW)().signMessageAsync,l=(0,R.Z)(),aw=l.toastSuccess,aA=l.toastError,q=(0,v.Z)((0,z.Z)((0,x.jsx)(aF,{block:c.snapshot})),1)[0],X=c.name,g=c.body,Y=c.choices,$=c.startDate,_=c.startTime,al=c.endDate,an=c.endTime,m=c.snapshot,b=ay(c,a),ao=(n=(0,r.Z)(w().mark(function b(c){var d,f,h,i,j;return w().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return c.preventDefault(),b.prev=1,aq(!0),d=JSON.stringify((0,u.Z)((0,t.Z)({},(0,ah.GB)()),{type:Q.Nl.PROPOSAL,payload:{name:X,body:g,snapshot:m,start:ax($,_),end:ax(al,an),choices:Y.filter(function(a){return a.value}).map(function(a){return a.value}),metadata:(0,ah.yx)(),type:"single-choice"}})),b.next=6,av({message:d});case 6:if(!(f=b.sent)){b.next=16;break}return h={address:e,msg:d,sig:f},b.next=11,(0,ah.Jl)(h);case 11:i=b.sent,au("/voting/proposal/".concat(i.ipfsHash)),aw(a("Proposal created!")),b.next=17;break;case 16:aA(a("Error"),a("Unable to sign payload"));case 17:b.next=25;break;case 19:b.prev=19,b.t0=b.catch(1),aA(a("Error"),null===(j=b.t0)|| void 0===j?void 0:j.message),console.error(b.t0),aq(!1);case 25:case"end":return b.stop()}},b,null,[[1,19]])})),function(a){return n.apply(this,arguments)}),aB=function(a,b){o(function(c){return(0,u.Z)((0,t.Z)({},c),(0,s.Z)({},a,b))}),ar(function(b){return(0,u.Z)((0,t.Z)({},b),(0,s.Z)({},a,!0))})},f=function(a){return function(b){aB(a,b)}},ap=(0,y.useMemo)(function(){return{hideIcons:e&&az.F_.includes(e.toLowerCase())?[]:["guide","fullscreen","preview","side-by-side","image"]}},[e]);return(0,y.useEffect)(function(){p>0&&o(function(a){return(0,u.Z)((0,t.Z)({},a),{snapshot:p})})},[p,o]),(0,x.jsxs)(W.Z,{py:"40px",children:[(0,x.jsx)(ae.V,{}),(0,x.jsx)(A.Z,{mb:"48px",children:(0,x.jsxs)(B.Z,{children:[(0,x.jsx)(ag(),{href:"/",children:a("Home")}),(0,x.jsx)(ag(),{href:"/voting",children:a("Voting")}),(0,x.jsx)(C.Z,{children:a("Make a Proposal")})]})}),(0,x.jsx)("form",{onSubmit:ao,children:(0,x.jsxs)(ai.Z,{children:[(0,x.jsxs)(A.Z,{children:[(0,x.jsxs)(A.Z,{mb:"24px",children:[(0,x.jsx)(aj,{htmlFor:"name",children:a("Title")}),(0,x.jsx)(D.Z,{id:"name",name:"name",value:X,scale:"lg",onChange:function(b){var a=b.currentTarget,c=a.name,d=a.value;aB(c,d)},required:!0}),b.name&&d.name&&(0,x.jsx)(am,{errors:b.name})]}),(0,x.jsxs)(A.Z,{mb:"24px",children:[(0,x.jsx)(aj,{htmlFor:"body",children:a("Content")}),(0,x.jsx)(C.Z,{color:"textSubtle",mb:"8px",children:a("Tip: write in Markdown!")}),(0,x.jsx)(aG,{id:"body",name:"body",onTextChange:function(a){aB("body",a)},value:g,options:ap,required:!0}),b.body&&d.body&&(0,x.jsx)(am,{errors:b.body})]}),g&&(0,x.jsx)(A.Z,{mb:"24px",children:(0,x.jsxs)(E.Z,{children:[(0,x.jsx)(F.Z,{children:(0,x.jsx)(G.Z,{as:"h3",scale:"md",children:a("Preview")})}),(0,x.jsx)(H.Z,{p:"0",px:"24px",children:(0,x.jsx)(ad.Z,{children:g})})]})}),(0,x.jsx)(at,{choices:Y,onChange:function(a){aB("choices",a)}}),b.choices&&d.choices&&(0,x.jsx)(am,{errors:b.choices})]}),(0,x.jsx)(A.Z,{children:(0,x.jsxs)(E.Z,{children:[(0,x.jsx)(F.Z,{children:(0,x.jsx)(G.Z,{as:"h3",scale:"md",children:a("Actions")})}),(0,x.jsxs)(H.Z,{children:[(0,x.jsxs)(A.Z,{mb:"24px",children:[(0,x.jsx)(ak,{children:a("Start Date")}),(0,x.jsx)(Z,{name:"startDate",onChange:f("startDate"),selected:$,placeholderText:"YYYY/MM/DD"}),b.startDate&&d.startDate&&(0,x.jsx)(am,{errors:b.startDate})]}),(0,x.jsxs)(A.Z,{mb:"24px",children:[(0,x.jsx)(ak,{children:a("Start Time")}),(0,x.jsx)(ab,{name:"startTime",onChange:f("startTime"),selected:_,placeholderText:"00:00"}),b.startTime&&d.startTime&&(0,x.jsx)(am,{errors:b.startTime})]}),(0,x.jsxs)(A.Z,{mb:"24px",children:[(0,x.jsx)(ak,{children:a("End Date")}),(0,x.jsx)(Z,{name:"endDate",onChange:f("endDate"),selected:al,placeholderText:"YYYY/MM/DD"}),b.endDate&&d.endDate&&(0,x.jsx)(am,{errors:b.endDate})]}),(0,x.jsxs)(A.Z,{mb:"24px",children:[(0,x.jsx)(ak,{children:a("End Time")}),(0,x.jsx)(ab,{name:"endTime",onChange:f("endTime"),selected:an,placeholderText:"00:00"}),b.endTime&&d.endTime&&(0,x.jsx)(am,{errors:b.endTime})]}),e&&(0,x.jsxs)(I.Z,{alignItems:"center",mb:"8px",children:[(0,x.jsx)(C.Z,{color:"textSubtle",mr:"16px",children:a("Creator")}),(0,x.jsx)(J.Z,{href:(0,S.s6)(e,"address"),children:(0,T.Z)(e)})]}),(0,x.jsxs)(I.Z,{alignItems:"center",mb:"16px",children:[(0,x.jsx)(C.Z,{color:"textSubtle",mr:"16px",children:a("Snapshot")}),(0,x.jsx)(J.Z,{href:(0,S.s6)(m,"block"),children:m})]}),e?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(K.Z,{type:"submit",width:"100%",isLoading:j,endIcon:j?(0,x.jsx)(L.Z,{spin:!0,color:"currentColor"}):null,disabled:!O()(b),mb:"16px",children:a("Publish")}),(0,x.jsxs)(C.Z,{color:"failure",as:"p",mb:"4px",children:[a("You need at least %count% voting power to publish a proposal.",{count:az.V5})," "]}),(0,x.jsx)(K.Z,{scale:"sm",type:"button",variant:"text",onClick:q,p:0,children:a("Check voting power")})]}):(0,x.jsx)(ac.Z,{width:"100%",type:"button"})]})]})})]})}),(0,x.jsx)(aa,{})]})}}},function(a){a.O(0,[2298,6600,4420,5547,4907,9774,2888,179],function(){var b;return a(a.s=42379)}),_N_E=a.O()}])
//# sourceMappingURL=create-de1c603b6727e1a1.js.map